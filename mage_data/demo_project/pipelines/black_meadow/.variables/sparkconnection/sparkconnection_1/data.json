"{\"data\": [\"\\u001b[0;31m---------------------------------------------------------------------------\\u001b[0m\", \"\\u001b[0;31mModuleNotFoundError\\u001b[0m                       Traceback (most recent call last)\", \"\\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/__init__.py\\u001b[0m in \\u001b[0;36m_execute_block\\u001b[0;33m(self, outputs_from_input_vars, custom_code, dynamic_block_index, dynamic_upstream_block_uuids, execution_partition, from_notebook, global_vars, input_vars, logger, logging_tags, input_from_output, runtime_arguments, upstream_block_uuids, run_settings, **kwargs)\\u001b[0m\\n\\u001b[1;32m   1128\\u001b[0m         \\u001b[0;32mif\\u001b[0m \\u001b[0mcustom_code\\u001b[0m \\u001b[0;32mis\\u001b[0m \\u001b[0;32mnot\\u001b[0m \\u001b[0;32mNone\\u001b[0m \\u001b[0;32mand\\u001b[0m \\u001b[0mcustom_code\\u001b[0m\\u001b[0;33m.\\u001b[0m\\u001b[0mstrip\\u001b[0m\\u001b[0;33m(\\u001b[0m\\u001b[0;33m)\\u001b[0m\\u001b[0;33m:\\u001b[0m\\u001b[0;33m\\u001b[0m\\u001b[0;33m\\u001b[0m\\u001b[0m\\n\\u001b[1;32m   1129\\u001b[0m             \\u001b[0;32mif\\u001b[0m \\u001b[0mBlockType\\u001b[0m\\u001b[0;33m.\\u001b[0m\\u001b[0mCHART\\u001b[0m \\u001b[0;33m!=\\u001b[0m \\u001b[0mself\\u001b[0m\\u001b[0;33m.\\u001b[0m\\u001b[0mtype\\u001b[0m\\u001b[0;33m:\\u001b[0m\\u001b[0;33m\\u001b[0m\\u001b[0;33m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m-> 1130\\u001b[0;31m                 \\u001b[0mexec\\u001b[0m\\u001b[0;33m(\\u001b[0m\\u001b[0mcustom_code\\u001b[0m\\u001b[0;33m,\\u001b[0m \\u001b[0mresults\\u001b[0m\\u001b[0;33m)\\u001b[0m\\u001b[0;33m\\u001b[0m\\u001b[0;33m\\u001b[0m\\u001b[0m\\n\\u001b[0m\\u001b[1;32m   1131\\u001b[0m         \\u001b[0;32melif\\u001b[0m \\u001b[0mself\\u001b[0m\\u001b[0;33m.\\u001b[0m\\u001b[0mcontent\\u001b[0m \\u001b[0;32mis\\u001b[0m \\u001b[0;32mnot\\u001b[0m \\u001b[0;32mNone\\u001b[0m\\u001b[0;33m:\\u001b[0m\\u001b[0;33m\\u001b[0m\\u001b[0;33m\\u001b[0m\\u001b[0m\\n\\u001b[1;32m   1132\\u001b[0m             \\u001b[0mexec\\u001b[0m\\u001b[0;33m(\\u001b[0m\\u001b[0mself\\u001b[0m\\u001b[0;33m.\\u001b[0m\\u001b[0mcontent\\u001b[0m\\u001b[0;33m,\\u001b[0m \\u001b[0mresults\\u001b[0m\\u001b[0;33m)\\u001b[0m\\u001b[0;33m\\u001b[0m\\u001b[0;33m\\u001b[0m\\u001b[0m\\n\", \"\\u001b[0;32m<string>\\u001b[0m in \\u001b[0;36m<module>\\u001b[0;33m\\u001b[0m\\n\", \"\\u001b[0;31mModuleNotFoundError\\u001b[0m: No module named 'pyspark'\"], \"error\": [\"\\u001b[0;31m---------------------------------------------------------------------------\\u001b[0m\", \"\\u001b[0;31mModuleNotFoundError\\u001b[0m                       Traceback (most recent call last)\", \"\\u001b[0;32m/tmp/ipykernel_61/2971037827.py\\u001b[0m in \\u001b[0;36m<cell line: 92>\\u001b[0;34m()\\u001b[0m\\n\\u001b[1;32m     90\\u001b[0m         \\u001b[0;32mreturn\\u001b[0m \\u001b[0mfind\\u001b[0m\\u001b[0;34m(\\u001b[0m\\u001b[0;32mlambda\\u001b[0m \\u001b[0mval\\u001b[0m\\u001b[0;34m:\\u001b[0m \\u001b[0mval\\u001b[0m \\u001b[0;32mis\\u001b[0m \\u001b[0;32mnot\\u001b[0m \\u001b[0;32mNone\\u001b[0m\\u001b[0;34m,\\u001b[0m \\u001b[0moutput\\u001b[0m\\u001b[0;34m)\\u001b[0m\\u001b[0;34m\\u001b[0m\\u001b[0;34m\\u001b[0m\\u001b[0m\\n\\u001b[1;32m     91\\u001b[0m \\u001b[0;34m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m---> 92\\u001b[0;31m \\u001b[0mdf\\u001b[0m \\u001b[0;34m=\\u001b[0m \\u001b[0mexecute_custom_code\\u001b[0m\\u001b[0;34m(\\u001b[0m\\u001b[0;34m)\\u001b[0m\\u001b[0;34m\\u001b[0m\\u001b[0;34m\\u001b[0m\\u001b[0m\\n\\u001b[0m\\u001b[1;32m     93\\u001b[0m \\u001b[0;34m\\u001b[0m\\u001b[0m\\n\\u001b[1;32m     94\\u001b[0m \\u001b[0;31m# Post processing code below (source: output_display.py)\\u001b[0m\\u001b[0;34m\\u001b[0m\\u001b[0;34m\\u001b[0m\\u001b[0m\\n\", \"\\u001b[0;32m/tmp/ipykernel_61/2971037827.py\\u001b[0m in \\u001b[0;36mexecute_custom_code\\u001b[0;34m()\\u001b[0m\\n\\u001b[1;32m     68\\u001b[0m         \\u001b[0mblock\\u001b[0m\\u001b[0;34m.\\u001b[0m\\u001b[0mrun_upstream_blocks\\u001b[0m\\u001b[0;34m(\\u001b[0m\\u001b[0mglobal_vars\\u001b[0m\\u001b[0;34m=\\u001b[0m\\u001b[0mglobal_vars\\u001b[0m\\u001b[0;34m,\\u001b[0m \\u001b[0mincomplete_only\\u001b[0m\\u001b[0;34m=\\u001b[0m\\u001b[0mrun_incomplete_upstream\\u001b[0m\\u001b[0;34m)\\u001b[0m\\u001b[0;34m\\u001b[0m\\u001b[0;34m\\u001b[0m\\u001b[0m\\n\\u001b[1;32m     69\\u001b[0m \\u001b[0;34m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m---> 70\\u001b[0;31m     block_output = block.execute_with_callback(\\n\\u001b[0m\\u001b[1;32m     71\\u001b[0m         \\u001b[0mcustom_code\\u001b[0m\\u001b[0;34m=\\u001b[0m\\u001b[0mcode\\u001b[0m\\u001b[0;34m,\\u001b[0m\\u001b[0;34m\\u001b[0m\\u001b[0;34m\\u001b[0m\\u001b[0m\\n\\u001b[1;32m     72\\u001b[0m         \\u001b[0mfrom_notebook\\u001b[0m\\u001b[0;34m=\\u001b[0m\\u001b[0;32mTrue\\u001b[0m\\u001b[0;34m,\\u001b[0m\\u001b[0;34m\\u001b[0m\\u001b[0;34m\\u001b[0m\\u001b[0m\\n\", \"\\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/__init__.py\\u001b[0m in \\u001b[0;36mexecute_with_callback\\u001b[0;34m(self, global_vars, logger, logging_tags, **kwargs)\\u001b[0m\\n\\u001b[1;32m    767\\u001b[0m                     \\u001b[0mparent_block\\u001b[0m\\u001b[0;34m=\\u001b[0m\\u001b[0mself\\u001b[0m\\u001b[0;34m,\\u001b[0m\\u001b[0;34m\\u001b[0m\\u001b[0;34m\\u001b[0m\\u001b[0m\\n\\u001b[1;32m    768\\u001b[0m                 )\\n\\u001b[0;32m--> 769\\u001b[0;31m             \\u001b[0;32mraise\\u001b[0m \\u001b[0me\\u001b[0m\\u001b[0;34m\\u001b[0m\\u001b[0;34m\\u001b[0m\\u001b[0m\\n\\u001b[0m\\u001b[1;32m    770\\u001b[0m \\u001b[0;34m\\u001b[0m\\u001b[0m\\n\\u001b[1;32m    771\\u001b[0m         \\u001b[0;32mfor\\u001b[0m \\u001b[0mcallback_block\\u001b[0m \\u001b[0;32min\\u001b[0m \\u001b[0mcallback_arr\\u001b[0m\\u001b[0;34m:\\u001b[0m\\u001b[0;34m\\u001b[0m\\u001b[0;34m\\u001b[0m\\u001b[0m\\n\", \"\\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/__init__.py\\u001b[0m in \\u001b[0;36mexecute_with_callback\\u001b[0;34m(self, global_vars, logger, logging_tags, **kwargs)\\u001b[0m\\n\\u001b[1;32m    752\\u001b[0m \\u001b[0;34m\\u001b[0m\\u001b[0m\\n\\u001b[1;32m    753\\u001b[0m         \\u001b[0;32mtry\\u001b[0m\\u001b[0;34m:\\u001b[0m\\u001b[0;34m\\u001b[0m\\u001b[0;34m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m--> 754\\u001b[0;31m             output = self.execute_sync(\\n\\u001b[0m\\u001b[1;32m    755\\u001b[0m                 \\u001b[0mglobal_vars\\u001b[0m\\u001b[0;34m=\\u001b[0m\\u001b[0mglobal_vars\\u001b[0m\\u001b[0;34m,\\u001b[0m\\u001b[0;34m\\u001b[0m\\u001b[0;34m\\u001b[0m\\u001b[0m\\n\\u001b[1;32m    756\\u001b[0m                 \\u001b[0mlogger\\u001b[0m\\u001b[0;34m=\\u001b[0m\\u001b[0mlogger\\u001b[0m\\u001b[0;34m,\\u001b[0m\\u001b[0;34m\\u001b[0m\\u001b[0;34m\\u001b[0m\\u001b[0m\\n\", \"\\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/__init__.py\\u001b[0m in \\u001b[0;36mexecute_sync\\u001b[0;34m(self, analyze_outputs, build_block_output_stdout, custom_code, execution_partition, from_notebook, global_vars, logger, logging_tags, run_all_blocks, update_status, store_variables, verify_output, input_from_output, runtime_arguments, dynamic_block_index, dynamic_block_uuid, dynamic_upstream_block_uuids, run_settings, output_messages_to_logs, disable_json_serialization, **kwargs)\\u001b[0m\\n\\u001b[1;32m    902\\u001b[0m             \\u001b[0;32mif\\u001b[0m \\u001b[0mupdate_status\\u001b[0m\\u001b[0;34m:\\u001b[0m\\u001b[0;34m\\u001b[0m\\u001b[0;34m\\u001b[0m\\u001b[0m\\n\\u001b[1;32m    903\\u001b[0m                 \\u001b[0mself\\u001b[0m\\u001b[0;34m.\\u001b[0m\\u001b[0mstatus\\u001b[0m \\u001b[0;34m=\\u001b[0m \\u001b[0mBlockStatus\\u001b[0m\\u001b[0;34m.\\u001b[0m\\u001b[0mFAILED\\u001b[0m\\u001b[0;34m\\u001b[0m\\u001b[0;34m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m--> 904\\u001b[0;31m             \\u001b[0;32mraise\\u001b[0m \\u001b[0merr\\u001b[0m\\u001b[0;34m\\u001b[0m\\u001b[0;34m\\u001b[0m\\u001b[0m\\n\\u001b[0m\\u001b[1;32m    905\\u001b[0m         \\u001b[0;32mfinally\\u001b[0m\\u001b[0;34m:\\u001b[0m\\u001b[0;34m\\u001b[0m\\u001b[0;34m\\u001b[0m\\u001b[0m\\n\\u001b[1;32m    906\\u001b[0m             \\u001b[0;32mif\\u001b[0m \\u001b[0mupdate_status\\u001b[0m\\u001b[0;34m:\\u001b[0m\\u001b[0;34m\\u001b[0m\\u001b[0;34m\\u001b[0m\\u001b[0m\\n\", \"\\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/__init__.py\\u001b[0m in \\u001b[0;36mexecute_sync\\u001b[0;34m(self, analyze_outputs, build_block_output_stdout, custom_code, execution_partition, from_notebook, global_vars, logger, logging_tags, run_all_blocks, update_status, store_variables, verify_output, input_from_output, runtime_arguments, dynamic_block_index, dynamic_block_uuid, dynamic_upstream_block_uuids, run_settings, output_messages_to_logs, disable_json_serialization, **kwargs)\\u001b[0m\\n\\u001b[1;32m    841\\u001b[0m                 )\\n\\u001b[1;32m    842\\u001b[0m \\u001b[0;34m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m--> 843\\u001b[0;31m             output = self.execute_block(\\n\\u001b[0m\\u001b[1;32m    844\\u001b[0m                 \\u001b[0mbuild_block_output_stdout\\u001b[0m\\u001b[0;34m=\\u001b[0m\\u001b[0mbuild_block_output_stdout\\u001b[0m\\u001b[0;34m,\\u001b[0m\\u001b[0;34m\\u001b[0m\\u001b[0;34m\\u001b[0m\\u001b[0m\\n\\u001b[1;32m    845\\u001b[0m                 \\u001b[0mcustom_code\\u001b[0m\\u001b[0;34m=\\u001b[0m\\u001b[0mcustom_code\\u001b[0m\\u001b[0;34m,\\u001b[0m\\u001b[0;34m\\u001b[0m\\u001b[0;34m\\u001b[0m\\u001b[0m\\n\", \"\\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/__init__.py\\u001b[0m in \\u001b[0;36mexecute_block\\u001b[0;34m(self, build_block_output_stdout, custom_code, execution_partition, from_notebook, global_vars, input_args, logger, logging_tags, input_from_output, runtime_arguments, dynamic_block_index, dynamic_upstream_block_uuids, run_settings, **kwargs)\\u001b[0m\\n\\u001b[1;32m   1075\\u001b[0m                     \\u001b[0mglobal_vars_copy\\u001b[0m\\u001b[0;34m.\\u001b[0m\\u001b[0mupdate\\u001b[0m\\u001b[0;34m(\\u001b[0m\\u001b[0mkwargs_var\\u001b[0m\\u001b[0;34m)\\u001b[0m\\u001b[0;34m\\u001b[0m\\u001b[0;34m\\u001b[0m\\u001b[0m\\n\\u001b[1;32m   1076\\u001b[0m \\u001b[0;34m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m-> 1077\\u001b[0;31m             outputs = self._execute_block(\\n\\u001b[0m\\u001b[1;32m   1078\\u001b[0m                 \\u001b[0moutputs_from_input_vars\\u001b[0m\\u001b[0;34m,\\u001b[0m\\u001b[0;34m\\u001b[0m\\u001b[0;34m\\u001b[0m\\u001b[0m\\n\\u001b[1;32m   1079\\u001b[0m                 \\u001b[0mcustom_code\\u001b[0m\\u001b[0;34m=\\u001b[0m\\u001b[0mcustom_code\\u001b[0m\\u001b[0;34m,\\u001b[0m\\u001b[0;34m\\u001b[0m\\u001b[0;34m\\u001b[0m\\u001b[0m\\n\", \"\\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/__init__.py\\u001b[0m in \\u001b[0;36m_execute_block\\u001b[0;34m(self, outputs_from_input_vars, custom_code, dynamic_block_index, dynamic_upstream_block_uuids, execution_partition, from_notebook, global_vars, input_vars, logger, logging_tags, input_from_output, runtime_arguments, upstream_block_uuids, run_settings, **kwargs)\\u001b[0m\\n\\u001b[1;32m   1128\\u001b[0m         \\u001b[0;32mif\\u001b[0m \\u001b[0mcustom_code\\u001b[0m \\u001b[0;32mis\\u001b[0m \\u001b[0;32mnot\\u001b[0m \\u001b[0;32mNone\\u001b[0m \\u001b[0;32mand\\u001b[0m \\u001b[0mcustom_code\\u001b[0m\\u001b[0;34m.\\u001b[0m\\u001b[0mstrip\\u001b[0m\\u001b[0;34m(\\u001b[0m\\u001b[0;34m)\\u001b[0m\\u001b[0;34m:\\u001b[0m\\u001b[0;34m\\u001b[0m\\u001b[0;34m\\u001b[0m\\u001b[0m\\n\\u001b[1;32m   1129\\u001b[0m             \\u001b[0;32mif\\u001b[0m \\u001b[0mBlockType\\u001b[0m\\u001b[0;34m.\\u001b[0m\\u001b[0mCHART\\u001b[0m \\u001b[0;34m!=\\u001b[0m \\u001b[0mself\\u001b[0m\\u001b[0;34m.\\u001b[0m\\u001b[0mtype\\u001b[0m\\u001b[0;34m:\\u001b[0m\\u001b[0;34m\\u001b[0m\\u001b[0;34m\\u001b[0m\\u001b[0m\\n\\u001b[0;32m-> 1130\\u001b[0;31m                 \\u001b[0mexec\\u001b[0m\\u001b[0;34m(\\u001b[0m\\u001b[0mcustom_code\\u001b[0m\\u001b[0;34m,\\u001b[0m \\u001b[0mresults\\u001b[0m\\u001b[0;34m)\\u001b[0m\\u001b[0;34m\\u001b[0m\\u001b[0;34m\\u001b[0m\\u001b[0m\\n\\u001b[0m\\u001b[1;32m   1131\\u001b[0m         \\u001b[0;32melif\\u001b[0m \\u001b[0mself\\u001b[0m\\u001b[0;34m.\\u001b[0m\\u001b[0mcontent\\u001b[0m \\u001b[0;32mis\\u001b[0m \\u001b[0;32mnot\\u001b[0m \\u001b[0;32mNone\\u001b[0m\\u001b[0;34m:\\u001b[0m\\u001b[0;34m\\u001b[0m\\u001b[0;34m\\u001b[0m\\u001b[0m\\n\\u001b[1;32m   1132\\u001b[0m             \\u001b[0mexec\\u001b[0m\\u001b[0;34m(\\u001b[0m\\u001b[0mself\\u001b[0m\\u001b[0;34m.\\u001b[0m\\u001b[0mcontent\\u001b[0m\\u001b[0;34m,\\u001b[0m \\u001b[0mresults\\u001b[0m\\u001b[0;34m)\\u001b[0m\\u001b[0;34m\\u001b[0m\\u001b[0;34m\\u001b[0m\\u001b[0m\\n\", \"\\u001b[0;32m<string>\\u001b[0m in \\u001b[0;36m<module>\\u001b[0;34m\\u001b[0m\\n\", \"\\u001b[0;31mModuleNotFoundError\\u001b[0m: No module named 'pyspark'\"], \"execution_state\": null, \"metadata\": null, \"msg_id\": \"115b8557-bde919a59d0c4973060cad48_7_0\", \"msg_type\": \"error\", \"type\": \"text\", \"block_type\": \"custom\", \"pipeline_uuid\": null, \"uuid\": \"sparkconnection\"}"